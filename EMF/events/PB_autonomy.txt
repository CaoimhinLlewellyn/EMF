
namespace = pb

# AF revolt call to arms
# Invoked from: CB af_legalize_cooperation, on_add_posttitle
#
# ROOT = AF member
# FROM = AF leader
# FROMFROM = liege
character_event = {
	id = pb.2100
	desc = "AF Revolt: Join the rebel cause, or stay loyal?"
	picture = GFX_evt_battle
	is_triggered_only = yes
	
	trigger = {
		de_facto_liege = FROMFROM
	}
	
	option = {
		name = "Rebellion it is!"
		ai_chance = { factor = 10 }
		
		# Setup inherited vassal-liege relations for revolt cleanup
		opinion = { who = FROMFROM modifier = opinion_af_target_rightful_liege years = 400 }
		reverse_opinion = { who = FROMFROM modifier = opinion_af_target_rightful_vassal years = 400 }
		
		# Swear temporary fealty to faction leader's temporary revolt title
		set_defacto_liege = FROM
	}
	
	option = {
		name = "My allegiance remains true."
		ai_chance = { factor = 0 }
	}
}

character_event = {
	id = pb.2998
	desc = "Instigate the AF leader to revolt."
	picture = GFX_evt_battle
	is_triggered_only = yes
	
	option = {
		name = OK
		
		d_poitou = { holder_scope = { add_trait = af_leader } }
		
		liege = {		
			primary_title = {
				d_poitou = {
					holder_scope = {
						war = {
							target = PREVPREVPREV
							casus_belli = af_legalize_cooperation
							thirdparty_title = PREVPREV
						}
					}
				}
			}
		}
	}
	
	option = {
		name = NO
	}
}
	
# Debug event for trigger/scope values in various CB states for various war participants
character_event = {
	id = pb.2999
	desc = "My scopes and triggers ought be inspected, apparently."
	picture = GFX_evt_battle
	is_triggered_only = yes
	
	option = {
		name = OK
		
		custom_tooltip = { text = dbg_char_ctt }
		
		if = { limit = { independent = yes }         custom_tooltip = { text = dbg_independent_ctt } }
		if = { limit = { independent = no }          custom_tooltip = { text = dbg_no_independent_ctt } }
		if = { limit = { in_revolt = yes }           custom_tooltip = { text = dbg_in_revolt_ctt } }
		if = { limit = { in_revolt = no }            custom_tooltip = { text = dbg_no_in_revolt_ctt } }
		if = { limit = { tier = DUKE }               custom_tooltip = { text = dbg_tier_duke_ctt } }
		if = { limit = { tier = KING }               custom_tooltip = { text = dbg_tier_king_ctt } }
		if = { limit = { tier = EMPEROR }            custom_tooltip = { text = dbg_tier_emperor_ctt } }
		if = { limit = { real_tier = DUKE }          custom_tooltip = { text = dbg_real_tier_duke_ctt } }
		if = { limit = { real_tier = KING }          custom_tooltip = { text = dbg_real_tier_king_ctt } }
		if = { limit = { real_tier = EMPEROR }       custom_tooltip = { text = dbg_real_tier_emperor_ctt } }
		if = { limit = { de_facto_liege = FROM }     custom_tooltip = { text = dbg_de_facto_liege_from_ctt } }
		if = { limit = { de_facto_liege = FROMFROM } custom_tooltip = { text = dbg_de_facto_liege_fromfrom_ctt } }
	
		custom_tooltip = { text = dbg_scope_ctt }

		liege = {
			custom_tooltip = { text = dbg_scope_liege_ctt }
			if = {
				limit = {
					NOT = {
						character = ROOT
					}
				}
				if = { limit = { independent = yes }         custom_tooltip = { text = dbg_independent_ctt } }
				if = { limit = { independent = no }          custom_tooltip = { text = dbg_no_independent_ctt } }
				if = { limit = { in_revolt = yes }           custom_tooltip = { text = dbg_in_revolt_ctt } }
				if = { limit = { in_revolt = no }            custom_tooltip = { text = dbg_no_in_revolt_ctt } }
				if = { limit = { tier = DUKE }               custom_tooltip = { text = dbg_tier_duke_ctt } }
				if = { limit = { tier = KING }               custom_tooltip = { text = dbg_tier_king_ctt } }
				if = { limit = { tier = EMPEROR }            custom_tooltip = { text = dbg_tier_emperor_ctt } }
				if = { limit = { real_tier = DUKE }          custom_tooltip = { text = dbg_real_tier_duke_ctt } }
				if = { limit = { real_tier = KING }          custom_tooltip = { text = dbg_real_tier_king_ctt } }
				if = { limit = { real_tier = EMPEROR }       custom_tooltip = { text = dbg_real_tier_emperor_ctt } }
			}
		}
		top_liege = {
			custom_tooltip = { text = dbg_scope_top_liege_ctt }
			if = {
				limit = {
					NOT = {
						character = ROOT
						ROOT = { liege = { character = PREVPREV } }
					}
				}
				if = { limit = { independent = yes }         custom_tooltip = { text = dbg_independent_ctt } }
				if = { limit = { independent = no }          custom_tooltip = { text = dbg_no_independent_ctt } }
				if = { limit = { in_revolt = yes }           custom_tooltip = { text = dbg_in_revolt_ctt } }
				if = { limit = { in_revolt = no }            custom_tooltip = { text = dbg_no_in_revolt_ctt } }
				if = { limit = { tier = DUKE }               custom_tooltip = { text = dbg_tier_duke_ctt } }
				if = { limit = { tier = KING }               custom_tooltip = { text = dbg_tier_king_ctt } }
				if = { limit = { tier = EMPEROR }            custom_tooltip = { text = dbg_tier_emperor_ctt } }
				if = { limit = { real_tier = DUKE }          custom_tooltip = { text = dbg_real_tier_duke_ctt } }
				if = { limit = { real_tier = KING }          custom_tooltip = { text = dbg_real_tier_king_ctt } }
				if = { limit = { real_tier = EMPEROR }       custom_tooltip = { text = dbg_real_tier_emperor_ctt } }
			}
		}
		liege_before_war = {
			custom_tooltip = { text = dbg_scope_liege_b4_war_ctt }
			if = {
				limit = {
					NOT = {
						character = ROOT
						ROOT = { liege = { character = PREVPREV } }
						ROOT = { top_liege = { character = PREVPREV } }
					}
				}
				if = { limit = { independent = yes }         custom_tooltip = { text = dbg_independent_ctt } }
				if = { limit = { independent = no }          custom_tooltip = { text = dbg_no_independent_ctt } }
				if = { limit = { in_revolt = yes }           custom_tooltip = { text = dbg_in_revolt_ctt } }
				if = { limit = { in_revolt = no }            custom_tooltip = { text = dbg_no_in_revolt_ctt } }
				if = { limit = { tier = DUKE }               custom_tooltip = { text = dbg_tier_duke_ctt } }
				if = { limit = { tier = KING }               custom_tooltip = { text = dbg_tier_king_ctt } }
				if = { limit = { tier = EMPEROR }            custom_tooltip = { text = dbg_tier_emperor_ctt } }
				if = { limit = { real_tier = DUKE }          custom_tooltip = { text = dbg_real_tier_duke_ctt } }
				if = { limit = { real_tier = KING }          custom_tooltip = { text = dbg_real_tier_king_ctt } }
				if = { limit = { real_tier = EMPEROR }       custom_tooltip = { text = dbg_real_tier_emperor_ctt } }
			}
		}
		
		primary_title = {
			custom_tooltip = { text = dbg_scope_primary_ctt }
			if = { limit = { temporary = yes }              custom_tooltip = { text = dbg_temporary_ctt } }
			if = { limit = { temporary = no }               custom_tooltip = { text = dbg_no_temporary_ctt } }
			if = { limit = { rebel = yes }                  custom_tooltip = { text = dbg_rebel_ctt } }
			if = { limit = { rebel = no }                   custom_tooltip = { text = dbg_no_rebel_ctt } }
			if = { limit = { is_landless_type_title = yes } custom_tooltip = { text = dbg_landless_ctt } }
			if = { limit = { is_landless_type_title = no }  custom_tooltip = { text = dbg_no_landless_ctt } }
			if = { limit = { is_primary_type_title = yes }  custom_tooltip = { text = dbg_primary_ctt } }
			if = { limit = { is_primary_type_title = no }   custom_tooltip = { text = dbg_no_primary_ctt } }
			if = { limit = { tier = DUKE }                  custom_tooltip = { text = dbg_tier_duke_ctt } }
			if = { limit = { tier = KING }                  custom_tooltip = { text = dbg_tier_king_ctt } }
			if = { limit = { tier = EMPEROR }               custom_tooltip = { text = dbg_tier_emperor_ctt } }
		}
		realm = {
			custom_tooltip = { text = dbg_scope_realm_ctt }
			if = {
				limit = {
					NOT = {
						ROOT = { primary_title = { title = PREVPREV } }
					}
				}
				if = { limit = { temporary = yes }              custom_tooltip = { text = dbg_temporary_ctt } }
				if = { limit = { temporary = no }               custom_tooltip = { text = dbg_no_temporary_ctt } }
				if = { limit = { rebel = yes }                  custom_tooltip = { text = dbg_rebel_ctt } }
				if = { limit = { rebel = no }                   custom_tooltip = { text = dbg_no_rebel_ctt } }
				if = { limit = { is_landless_type_title = yes } custom_tooltip = { text = dbg_landless_ctt } }
				if = { limit = { is_landless_type_title = no }  custom_tooltip = { text = dbg_no_landless_ctt } }
				if = { limit = { is_primary_type_title = yes }  custom_tooltip = { text = dbg_primary_ctt } }
				if = { limit = { is_primary_type_title = no }   custom_tooltip = { text = dbg_no_primary_ctt } }
				if = { limit = { tier = DUKE }                  custom_tooltip = { text = dbg_tier_duke_ctt } }
				if = { limit = { tier = KING }                  custom_tooltip = { text = dbg_tier_king_ctt } }
				if = { limit = { tier = EMPEROR }               custom_tooltip = { text = dbg_tier_emperor_ctt } }
			}
		}
	}
}
