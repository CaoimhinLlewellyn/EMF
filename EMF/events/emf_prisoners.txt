namespace = emf_prisoners

## Ransom All events
## 0-9 reserved
# These are hideous and badly need some attention
character_event = {
	id = emf_prisoners.0
	desc = "ransomall.0.desc"
	picture = "GFX_evt_into_the_dungeon"
	is_triggered_only = yes

	option = {
		name = "ransomall.0.a" # Will pay
		
		ai_chance = { factor = 100 }
		
		#require money for ransom
		if = {
			limit = {
				tier = emperor
				wealth = 385
			} 

			wealth = -385
			host = {
				wealth = 385
			}
			prisoner = no
		}
		
		if = {
			limit = {
				tier = king
				wealth = 250
			} 
			
			wealth = -250
			host = {
				wealth = 250
			}
			prisoner = no
		}
		
		if = {
			limit = {
				tier = duke
				wealth = 145
			} 
			
			wealth = -145
			host = {
				wealth = 145
			}
			prisoner = no
		}
		
		if = {
			limit = {
				tier = count
				wealth = 70
			} 
			
			wealth = -70
			host = {
				wealth = 70
			}
			prisoner = no
		}
		
		if = {
			limit = {
				tier = baron
				wealth = 25
			} 
			
			wealth = -25
			host = {
				wealth = 25
			}
			prisoner = no
		}
		
		if = {
			limit = {
				is_ruler = no
				wealth = 10
			} 

			wealth = -10
			host = {
				wealth = 10
			}
			prisoner = no
		}
		
		if = {
			limit = {
				is_ruler = no
				prisoner = yes
				father = {
					wealth = 26
					current_heir = { character = ROOT }
					ai = no
				}
			}
			father = { wealth = -26 }
			host = { wealth = 26 }
			prisoner = no
		}
		
		if = {
			limit = {
				is_ruler = no
				prisoner = yes
				mother = {
					wealth = 26
					current_heir = { character = ROOT }
					ai = no
				}
			}
			mother = { wealth = -26 }
			host = { wealth = 26 }
		}
		
		if = {
			limit = {
				is_ruler = no
				prisoner = yes
				NOT = { wealth = 10 }
			} 
			liege = { character_event = { id = emf_prisoners.1 } }
		}
	}
	
	option = {
		name = "ransomall.0.b" # will not pay
		ai_chance = {
			factor = 0
		}
	}
}


character_event = {
	id = emf_prisoners.1
	desc = "ransomall.0.w"
	picture = "GFX_evt_into_the_dungeon"
	is_triggered_only = yes

	option = {
		name = "ransomall.0.w1" # Will pay
		
		ai_chance = { 
			factor = 1
			modifier = {
				factor = 2 
				trait = charitable
			}
			modifier = {
				factor = 2 
				trait = kind
			}
			modifier = {
				factor = 2 
				trait = just
			}
			modifier = {
				factor = 1.25 
				wealth = 200
			}
			modifier = {
				factor = 1.5 
				wealth = 250
			}
			modifier = {
				factor = 2 
				wealth = 300
			}
			modifier = {
				factor = 50 
				wealth = 400
			}
			modifier = {
				factor = 100 
				wealth = 500
			}
			modifier = {
				factor = 100 
				FROM = { is_close_relative = ROOT } 
			}
			
		}#ai

		ROOT = { wealth = -10 }
		FROMFROM = { wealth = 10 }
		
		FROM = { prisoner = no }

	}#opt
	option = {
		name = "ransomall.0.w2" #will not

		ai_chance = {
			factor = 0.5
			modifier = {
				factor = 2 
				trait = greedy
			}
			modifier = {
				factor = 2 
				trait = wroth
			}
			modifier = {
				factor = 1.5 
				trait = cruel
			}
			modifier = {
				factor = 2.5 
				NOT = { wealth = 75 } 
			}
			modifier = {
				factor = 5 
				NOT = { wealth = 50 } 
			}
			modifier = {
				factor = 10 
				NOT = { wealth = 25} 
			}
			

		}#ai
		FROMFROM = { character_event = { id = emf_prisoners.2 } }

	}#opt

}#evt



character_event = {
	id = emf_prisoners.2
	desc = "ransomall.0.ww"
	picture = "GFX_evt_into_the_dungeon"
	is_triggered_only = yes

	option = {
		name = "ransomall.0.ww1" # denied

	}#opt
}#evt


## Prisoner Exchange events
## 10-19 reserved
# These also badly need to be fixed up
#Prisoner exchange
character_event = {
	id = emf_prisoners.10
	desc = meneth.213.desc
	picture = GFX_evt_emissary
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = meneth.213.a
		trigger = {
			FROMFROM = {
				any_courtier = {
					dynasty = ROOT
					prisoner = yes
					is_landed = no
				}
			}
		}
		FROMFROM = { clr_character_flag = prisoner_exchange_attempted }
		FROM = {
			prisoner = no
		}
		FROMFROM = {
			random_courtier = {
				limit = {
					is_close_relative = ROOT
					dynasty = ROOT
					prisoner = yes
					is_landed = no
				}
				prisoner = no
			}
			if = {
				limit = {
					NOT = {
						any_courtier = {
							is_close_relative = ROOT
							dynasty = ROOT
							prisoner = yes
							is_landed = no
						}
					}
				}
				random_courtier = {
					limit = {
						dynasty = ROOT
						prisoner = yes
						is_landed = no
					}
					prisoner = no
				}
			}
			character_event = { id = emf_prisoners.11 } #Prisoner exchange succeeded
		}
	}
	option = {
		name = meneth.213.b
		trigger = {
			OR = {
				ai = no
				NOT = {
					FROMFROM = {
						any_courtier = {
							dynasty = ROOT
							prisoner = yes
							is_landed = no
						}
					}
				}
			}
		}
		FROMFROM = { clr_character_flag = prisoner_exchange_attempted }
		FROMFROM = { character_event = { id = emf_prisoners.12 } } #Prisoner exchange fails
	}
}

#Prisoner exchange succeeds
character_event = {
	id = emf_prisoners.11
	desc = meneth.214.desc
	picture = GFX_evt_garden
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
	}
}

#Prisoner exchange fails
character_event = {
	id = emf_prisoners.12
	desc = meneth.215.desc
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = CURSES
	}
}


## Prisoner Handling events
## 20-29 reserved
# House Arrest event
character_event = {
	id = emf_prisoners.20
	desc = {
		text = emf_prisoners.20.desc_dungeon
		trigger = { has_character_modifier = the_dungeon }
	}
	desc = {
		text = emf_prisoners.20.desc_oubliette
		trigger = { has_character_modifier = the_oubliette }
	}
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_intrigue
	is_triggered_only = yes
	
	option = {
		name = emf_prisoners.20.a

		hidden_tooltip = {
			remove_character_modifier = house_arrest
			remove_character_modifier = the_dungeon
			remove_character_modifier = the_oubliette
		}
		if = {
			limit = { prisoner = yes }
			add_character_modifier = { 
				name = house_arrest
				duration = -1
			}
		}
	}
}

# Oubliette event
character_event = {
	id = emf_prisoners.21
	desc = emf_prisoners.21.desc
	desc = {
		text = emf_prisoners.21.desc_house
		trigger = { has_character_modifier = house_arrest }
	}
	desc = {
		text = emf_prisoners.21.desc_dungeon
		trigger = { has_character_modifier = the_dungeon }
	}
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_intrigue
	is_triggered_only = yes
	
	option = {
		name = emf_prisoners.21.a

		hidden_tooltip = {
			remove_character_modifier = house_arrest
			remove_character_modifier = the_dungeon
			remove_character_modifier = the_oubliette
		}
		if = {
			limit = { prisoner = yes }
			add_character_modifier = { 
				name = the_oubliette
				duration = -1
			}
		}
	}
}

# Dungeon event
character_event = {
	id = emf_prisoners.22
	desc = emf_prisoners.22.desc
	desc = {
		text = emf_prisoners.22.desc_house
		trigger = { has_character_modifier = house_arrest }
	}
	desc = {
		text = emf_prisoners.22.desc_oubliette
		trigger = { has_character_modifier = the_oubliette }
	}
	picture = GFX_evt_into_the_dungeon
	border = GFX_event_normal_frame_intrigue
	is_triggered_only = yes
	
	option = {
		name = {
			text = emf_prisoners.22.a_house
			trigger = { has_character_modifier = house_arrest }
		}
		name = {
			text = emf_prisoners.22.a_oubliette
			trigger = { has_character_modifier = the_oubliette }
		}

		hidden_tooltip = {
			remove_character_modifier = house_arrest
			remove_character_modifier = the_dungeon
			remove_character_modifier = the_oubliette
		}
		if = {
			limit = { prisoner = yes }
			add_character_modifier = { 
				name = the_oubliette
				duration = -1
			}
		}
	}
}
