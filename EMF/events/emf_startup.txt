
namespace = emf_startup


character_event = {
	id = emf_startup.0
	desc = AI_EVENT
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		# Destroy de jure k_ireland title if SWMH
		k_ireland = { destroy_landed_title = THIS }

		if = {
			limit = {
				b_hagiasophia = {
					owner = {
						religion = catholic
					}
				}
			}
			k_orthodox = {
				owner = {
					b_hagiasophia = {
						grant_title_no_opinion = PREV
					}
				}
			}
		}
		
		# Vanilla map dynamic de jure changes
		character_event = { id = emf_startup.2 }
		
		# Initialize dynlevy
		character_event = { id = emf_dynlevy.0 }
	}
	
	option = {
		name = OK
		
		# Welcome event
		narrative_event = { id = emf_startup.1 }
	}
}


narrative_event = {
	id    = emf_startup.1
	desc  = emf_startup.1.desc
	title = emf_startup.1.title

	picture = GFX_evt_rainy_lanterns
	border  = GFX_event_narrative_frame_diplomacy
	
	major = yes
	hide_from = yes
	is_triggered_only = yes
	
	option = { name = emf_startup.1.opt.a }
}


# Vanilla map dynamic de jure changes
character_event = {
	id = emf_startup.2
	desc = AI_EVENT
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		k_sicily = {
			de_jure_liege = e_byzantium # Only true for vanilla
		}
	}
	
	immediate = {
		k_sicily = { de_jure_liege = e_italy }
		k_venice = { de_jure_liege = e_italy }
		k_croatia = { de_jure_liege = e_carpathia }
		
		d_cibyrrhaeot = { de_jure_liege = k_anatolia }
		
		d_trebizond = { de_jure_liege = k_trebizond }
		d_paphlagonia = { de_jure_liege = k_trebizond }
		d_armeniacon = { de_jure_liege = k_trebizond }

		d_nikaea = { de_jure_liege = k_nikaea }
		d_samos = { de_jure_liege = k_nikaea }
		d_cyprus = { de_jure_liege = k_nikaea }
		
		d_thrace = { de_jure_liege = k_thessalonika }
		d_adrianopolis = { de_jure_liege = k_thessalonika }
		d_thessalonika = { de_jure_liege = k_thessalonika }
		d_athens = { de_jure_liege = k_thessalonika }
		d_aegean_islands = { de_jure_liege = k_thessalonika }
		
		d_dyrrachion = { de_jure_liege = k_epirus }
		d_epirus = { de_jure_liege = k_epirus }
		d_achaia = { de_jure_liege = k_epirus }
		d_krete = { de_jure_liege = k_epirus }
		
		k_byzantium = {
			destroy_landed_title = THIS
			de_jure_liege = 0
		}
		activate_title = { title = k_byzantium status = no }
	}
	
	option = { name = OK }
}
