
namespace = emf_core

# emf_core.0 [Player]
#
# on_death handler for player characters. Inherits intrigue
# menu character flag state for now. Cushy.
character_event = {
	id = emf_core.0
	desc = HIDE_EVENT
	hide_window = yes
	is_triggered_only = yes
	
	ai = no

	immediate = {
		current_heir = {
			if = {
				limit = { ROOT = { has_character_flag = emf_toggle_customization_off } }
				set_character_flag = emf_toggle_customization_off
			}
			if = {
				limit = { ROOT = { has_character_flag = toggle_employment } }
				set_character_flag = toggle_employment
			}
			if = {
				limit = { ROOT = { has_character_flag = holy_war_check } }
				set_character_flag = holy_war_check
			}
			if = {
				limit = { ROOT = { has_character_flag = enable_marriage_decisions } }
				set_character_flag = enable_marriage_decisions
			}
			if = {
				limit = { ROOT = { has_character_flag = loan_decisions } }
				set_character_flag = loan_decisions
			}
		}
	}
	
	option = { name = OK }
}


# emf_core.9
#
# Called from the pass_effect of crown authority laws.
# Crown authority was raised, so apply appropriate temporary
# opinions.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.9
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		not = { has_character_flag = emf_no_law_penalties }
	}
	
	immediate = {
		FROM = {
			any_de_jure_vassal = {
				limit = {
					or = {
						vassal_of = ROOT
						and = {
							higher_tier_than = baron
							is_liege_or_above = ROOT
						}
					}
				}
				opinion = {
					who = ROOT
					modifier = opinion_increased_authority
					months = 60
				}
			}
		}
	}
}


# emf_core.10
#
# Called from the pass_effect of crown_authority_0
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.10
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = yes }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { not = { has_law = revokation_0 } }
				add_law_w_cooldown = revokation_0
			}
			if = {
				limit = { not = { has_law = king_peace_0 } }
				add_law_w_cooldown = king_peace_0
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law_w_cooldown = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.11
#
# Called from the pass_effect of crown_authority_1
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.11
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = yes }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { not = { has_law = revokation_1 } }
				add_law_w_cooldown = revokation_1
			}
			if = {
				limit = { not = { has_law = king_peace_0 } }
				add_law_w_cooldown = king_peace_0
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law_w_cooldown = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.12
#
# Called from the pass_effect of crown_authority_2
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.12
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = yes }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = revokation_2 }
				}
				add_law_w_cooldown = revokation_2
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = revokation_1 }
				}
				add_law_w_cooldown = revokation_1
			}
			if = {
				limit = { not = { has_law = king_peace_1 } }
				add_law_w_cooldown = king_peace_1
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law_w_cooldown = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.13
#
# Called from the pass_effect of crown_authority_3
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.13
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = yes }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = revokation_2 }
				}
				add_law_w_cooldown = revokation_2
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = revokation_1 }
				}
				add_law_w_cooldown = revokation_1
			}
			if = {
				limit = { not = { has_law = king_peace_1 } }
				add_law_w_cooldown = king_peace_1
			}
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = inheritance_1 }
				}
				add_law_w_cooldown = inheritance_1
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = inheritance_0 }
				}
				add_law_w_cooldown = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.14
#
# Called from the pass_effect of crown_authority_4
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.14
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = yes }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = revokation_2 }
				}
				add_law_w_cooldown = revokation_2
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = revokation_1 }
				}
				add_law_w_cooldown = revokation_1
			}
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = king_peace_2 }
				}
				add_law_w_cooldown = king_peace_2
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = king_peace_1 }
				}
				add_law_w_cooldown = king_peace_1
			}
			if = {
				limit = {
					not = { has_law = succ_feudal_elective }
					not = { has_law = inheritance_1 }
				}
				add_law_w_cooldown = inheritance_1
			}
			if = {
				limit = {
					has_law = succ_feudal_elective
					not = { has_law = inheritance_0 }
				}
				add_law_w_cooldown = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.15 [Player]
#
# Called from the pass_effect of crown_authority_0
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.15
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = no }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { not = { has_law = revokation_0 } }
				add_law = revokation_0
			}
			if = {
				limit = { not = { has_law = king_peace_0 } }
				add_law = king_peace_0
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.16 [Player]
#
# Called from the pass_effect of crown_authority_1
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.16
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = no }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { has_law = revokation_2 }
				add_law = revokation_1
			}
			if = {
				limit = { not = { has_law = king_peace_0 } }
				add_law = king_peace_0
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.17 [Player]
#
# Called from the pass_effect of crown_authority_2
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.17
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = no }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { has_law = king_peace_2 }
				add_law = king_peace_1
			}
			if = {
				limit = { not = { has_law = inheritance_0 } }
				add_law = inheritance_0
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.18 [Player]
#
# Called from the pass_effect of crown_authority_3
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.18
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { ai = no }
	
	immediate = {
		set_character_flag = emf_no_law_penalties
		
		FROM = {
			if = {
				limit = { has_law = king_peace_2 }
				add_law = king_peace_1
			}
		}
		
		clr_character_flag = emf_no_law_penalties
	}
}


# emf_core.19 [Player]
#
# Called from the pass_effect of crown_authority_4
# Adjusts specific CA laws to those appropriate for level.
#
# FROM = title upon which law was passed
character_event = {
	id = emf_core.19
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { always = no }
	
	option = {
		name = OK
	}
}
